# 前端代码编写约定规则

## 概述

本文档定义了基于 Vue 3 + Vuetify 3.x + TypeScript 技术栈的前端项目代码编写规范和约定。遵循这些规范有助于提高代码质量、可维护性和团队协作效率。

## 技术栈

- **前端框架**: Vue 3 (Composition API)
- **UI 组件库**: Vuetify 3.x
- **编程语言**: TypeScript
- **构建工具**: Vite
- **状态管理**: Pinia
- **路由管理**: Vue Router 4
- **测试框架**: Vitest + Vue Test Utils
- **代码规范**: ESLint + Prettier

## 规范文档导航

### 核心编码规范

1. **[Vue 组件编写规范](./vue-component-rules.md)**
   - 组件结构和命名
   - Composition API 使用规范
   - 组件通信和生命周期
   - 模板编写规范

2. **[TypeScript 编码规范](./typescript-rules.md)**
   - 类型定义和接口规范
   - 泛型使用规范
   - 模块导入导出规范
   - 类型安全最佳实践

3. **[Vuetify 组件使用规范](./vuetify-rules.md)**
   - Vuetify 组件选择和使用
   - 主题定制规范
   - 响应式设计规范
   - 无障碍访问规范

### 质量保证规范

4. **[测试编写规范](./testing-rules.md)**
   - 单元测试规范
   - 组件测试规范
   - 集成测试规范
   - 测试覆盖率要求

5. **[代码格式化和 ESLint 配置规范](./formatting-rules.md)**
   - ESLint 配置规则
   - Prettier 格式化规范
   - Git 提交规范
   - 代码审查规范

## 基本原则

### 1. 代码可读性
- 使用有意义的变量名和函数名
- 添加必要的注释和文档
- 保持代码结构清晰简洁

### 2. 类型安全
- 充分利用 TypeScript 的类型系统
- 避免使用 `any` 类型
- 为所有函数和变量提供明确的类型定义

### 3. 组件化设计
- 遵循单一职责原则
- 保持组件的可复用性
- 合理划分组件粒度

### 4. 性能优化
- 合理使用 Vue 3 的响应式系统
- 避免不必要的重新渲染
- 优化组件的加载和渲染性能

### 5. 可维护性
- 保持代码的一致性
- 遵循项目的目录结构规范
- 编写可测试的代码

## 文件和目录命名规范

### 文件命名
- **Vue 组件**: 使用 PascalCase，如 `UserProfile.vue`
- **TypeScript 文件**: 使用 camelCase，如 `userService.ts`
- **样式文件**: 使用 kebab-case，如 `user-profile.scss`
- **测试文件**: 使用 `.test.ts` 或 `.spec.ts` 后缀

### 目录命名
- 使用 kebab-case，如 `user-management`
- 保持目录结构的一致性和逻辑性

## 注释规范

### 1. 文件级注释

每个文件都应该包含文件级注释，说明文件的用途、作者和创建时间。

#### TypeScript 文件
```typescript
/**
 * @fileoverview 用户管理相关服务
 * @description 提供用户数据的增删改查功能，包括用户认证和权限管理
 * @author 张三 <zhangsan@example.com>
 * @created 2024-01-20
 * @updated 2024-01-20
 * @version 1.0.0
 */
```

#### Vue 组件文件
```vue
<!--
/**
 * @fileoverview 用户信息展示组件
 * @description 展示用户基本信息，支持编辑和删除操作
 * @author 李四 <lisi@example.com>
 * @created 2024-01-20
 * @updated 2024-01-20
 * @version 1.0.0
 * @props {User} user - 用户信息对象
 * @emits {string} update - 用户信息更新事件
 * @emits {string} delete - 用户删除事件
 */
-->
```

### 2. 类级注释

类注释应该描述类的职责、主要功能和使用场景。

```typescript
/**
 * 用户信息管理类
 * 
 * @description 负责处理用户数据的增删改查操作，提供用户认证和权限验证功能
 * @example
 * ```typescript
 * const userManager = new UserManager();
 * const user = await userManager.getUserById('123');
 * ```
 * @since 1.0.0
 */
export class UserManager {
  /**
   * 用户数据缓存
   * @private
   */
  private userCache: Map<string, User> = new Map();

  /**
   * API 服务实例
   * @private
   */
  private apiService: ApiService;
}
```

### 3. 函数/方法级注释

函数注释应该包含功能描述、参数说明、返回值和可能的异常。

```typescript
/**
 * 获取用户信息
 * 
 * @description 根据用户ID获取用户详细信息，支持缓存机制
 * @param userId - 用户唯一标识符
 * @param options - 可选配置参数
 * @param options.useCache - 是否使用缓存，默认为 true
 * @param options.timeout - 请求超时时间（毫秒），默认为 5000
 * @returns Promise<User> 用户信息对象
 * @throws {UserNotFoundError} 当用户不存在时抛出
 * @throws {NetworkError} 当网络请求失败时抛出
 * @example
 * ```typescript
 * try {
 *   const user = await getUserInfo('123', { useCache: false });
 *   console.log(user.name);
 * } catch (error) {
 *   console.error('获取用户信息失败:', error.message);
 * }
 * ```
 * @since 1.0.0
 */
async function getUserInfo(
  userId: string,
  options: {
    useCache?: boolean;
    timeout?: number;
  } = {}
): Promise<User> {
  // 函数实现
}
```

### 4. 接口和类型注释

接口和类型定义应该包含详细的属性说明。

```typescript
/**
 * 用户信息接口
 * 
 * @description 定义用户的基本信息结构
 * @since 1.0.0
 */
export interface User {
  /** 用户唯一标识符 */
  id: string;
  
  /** 用户名，长度为 3-20 个字符 */
  username: string;
  
  /** 用户邮箱地址 */
  email: string;
  
  /** 用户头像 URL，可选 */
  avatar?: string;
  
  /** 用户创建时间 */
  createdAt: Date;
  
  /** 用户最后更新时间 */
  updatedAt: Date;
  
  /** 用户角色列表 */
  roles: UserRole[];
}

/**
 * 用户角色枚举
 * 
 * @description 定义系统中的用户角色类型
 */
export enum UserRole {
  /** 管理员 */
  ADMIN = 'admin',
  
  /** 普通用户 */
  USER = 'user',
  
  /** 访客 */
  GUEST = 'guest'
}
```

### 5. Vue 组件注释规范

#### Composition API 注释
```vue
<script setup lang="ts">
/**
 * 用户列表组件的组合式 API 逻辑
 * 
 * @description 处理用户列表的数据获取、筛选和分页功能
 */

/**
 * 用户列表响应式数据
 */
const users = ref<User[]>([]);

/**
 * 加载状态
 */
const loading = ref(false);

/**
 * 获取用户列表
 * 
 * @description 从服务器获取用户列表数据
 * @param page - 页码，从 1 开始
 * @param pageSize - 每页数量，默认为 10
 */
const fetchUsers = async (page: number = 1, pageSize: number = 10): Promise<void> => {
  loading.value = true;
  try {
    // 实现逻辑
  } finally {
    loading.value = false;
  }
};

/**
 * 组件挂载时获取数据
 */
onMounted(() => {
  fetchUsers();
});
</script>
```

#### 模板注释
```vue
<template>
  <!-- 用户列表容器 -->
  <v-container>
    <!-- 页面标题 -->
    <v-row>
      <v-col>
        <h1>用户管理</h1>
      </v-col>
    </v-row>
    
    <!-- 用户列表表格 -->
    <v-row>
      <v-col>
        <v-data-table
          :headers="headers"
          :items="users"
          :loading="loading"
          class="elevation-1"
        >
          <!-- 操作列插槽 -->
          <template #item.actions="{ item }">
            <v-btn
              icon="mdi-pencil"
              size="small"
              @click="editUser(item)"
            />
            <v-btn
              icon="mdi-delete"
              size="small"
              color="error"
              @click="deleteUser(item)"
            />
          </template>
        </v-data-table>
      </v-col>
    </v-row>
  </v-container>
</template>
```

### 6. 常量和配置注释

```typescript
/**
 * API 配置常量
 * 
 * @description 定义应用程序的 API 相关配置
 */
export const API_CONFIG = {
  /** API 基础 URL */
  BASE_URL: 'https://api.example.com',
  
  /** 请求超时时间（毫秒） */
  TIMEOUT: 10000,
  
  /** API 版本 */
  VERSION: 'v1'
} as const;

/**
 * 用户状态常量
 * 
 * @description 定义用户的各种状态值
 */
export const USER_STATUS = {
  /** 活跃状态 */
  ACTIVE: 'active',
  
  /** 非活跃状态 */
  INACTIVE: 'inactive',
  
  /** 已删除状态 */
  DELETED: 'deleted'
} as const;
```

### 7. 注释最佳实践

#### 必须添加注释的情况
- 所有公共 API（函数、类、接口）
- 复杂的业务逻辑
- 算法实现
- 正则表达式
- 魔法数字和字符串
- 临时解决方案（TODO 注释）

#### 注释编写原则
- **准确性**: 注释必须与代码保持同步
- **简洁性**: 避免冗余和显而易见的注释
- **完整性**: 重要信息不能遗漏
- **一致性**: 遵循统一的注释格式

#### TODO 注释规范
```typescript
/**
 * TODO: 优化用户查询性能
 * @author 张三
 * @date 2024-01-20
 * @priority high
 * @description 当前查询效率较低，需要添加索引和缓存机制
 */
function queryUsers() {
  // 当前实现
}

/**
 * FIXME: 修复用户删除时的数据一致性问题
 * @author 李四
 * @date 2024-01-20
 * @issue #123
 */
function deleteUser(userId: string) {
  // 存在问题的实现
}
```

#### 废弃代码注释
```typescript
/**
 * @deprecated 此方法已废弃，请使用 getUserInfoV2 替代
 * @since 1.0.0
 * @removal 2.0.0
 * @see getUserInfoV2
 */
function getUserInfo(userId: string): Promise<User> {
  // 废弃的实现
}
```

## 版本控制

- **版本**: v1.0.0
- **最后更新**: 2024-01-20
- **维护者**: 前端开发团队

## 相关链接

- [项目文件映射](../项目文件映射.md)
- [Vue 3 官方文档](https://vuejs.org/)
- [Vuetify 3 官方文档](https://vuetifyjs.com/)
- [TypeScript 官方文档](https://www.typescriptlang.org/)